import{d as w,z as S,u as D,n as I,l as n,m as k,c as v,o as m,b as e,t as c,s as g}from"./index-BcwZ1Jdz.js";import{c as E}from"./appointments.actions-CpBwOtv9.js";import{a as N,b as R}from"./dateUtils-DJHNyQvN.js";const T={class:"min-h-screen bg-gray-100 py-12 px-4 sm:px-6 lg:px-8"},Y={class:"max-w-4xl mx-auto"},C={class:"bg-white rounded-lg shadow-lg overflow-hidden"},$={class:"p-8"},B={key:0,class:"text-center py-8"},M={key:1,class:"space-y-6"},A={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},J={class:"text-gray-600"},O={class:"text-sm text-gray-500 mt-1"},P={class:"text-gray-600"},V={class:"text-gray-600"},j={class:"border-t border-gray-200 pt-6"},z={class:"flex justify-between"},F=["disabled"],L=w({__name:"ReservationDetailsPage",setup(H){const p=S(),u=D(),f=I(),d=n(!1),h=n(null),a=n(null),l=n(""),i=n(""),y=()=>{const o=localStorage.getItem("selectedService"),t=localStorage.getItem("selectedDateTime");if(o&&(a.value=JSON.parse(o)),t){const{date:s,time:r}=JSON.parse(t);l.value=s,i.value=r}};k(()=>{y(),(!a.value||!l.value||!i.value)&&u.push("/service")});const _=async()=>{var o,t;try{if(d.value=!0,h.value=null,!((o=f.user)!=null&&o.id))throw new Error("No se ha encontrado el ID del usuario");if(!((t=a.value)!=null&&t.id))throw new Error("No se ha seleccionado un servicio");if(!l.value||!i.value)throw new Error("No se ha seleccionado una fecha y hora");const[s,r,x]=l.value.split("-"),b=`${x}-${r}-${s}`;await E({userId:f.user.id,date:b,time:i.value,serviceId:a.value.id,status:"confirmed"}),p.success("Reserva confirmada con éxito"),localStorage.removeItem("selectedService"),localStorage.removeItem("selectedDateTime"),u.push("/user")}catch(s){h.value=s instanceof Error?s.message:"Error al confirmar la reserva",p.error("Ya existe una reserva para esta fecha y hora")}finally{d.value=!1}};return(o,t)=>{var s,r;return m(),v("div",T,[e("div",Y,[e("div",C,[e("div",$,[t[4]||(t[4]=e("h2",{class:"text-2xl font-bold text-gray-900 mb-6"},"Detalles de la Reserva",-1)),d.value?(m(),v("div",B,t[1]||(t[1]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"},null,-1),e("p",{class:"mt-4 text-gray-600"},"Procesando reserva...",-1)]))):(m(),v("div",M,[e("div",A,[e("div",null,[t[2]||(t[2]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Servicio",-1)),e("p",J,c((s=a.value)==null?void 0:s.description),1),e("p",O," Duración: "+c((r=a.value)==null?void 0:r.duration)+" minutos ",1)]),e("div",null,[t[3]||(t[3]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Fecha y Hora",-1)),e("p",P,c(g(N)(g(R)(l.value))),1),e("p",V,c(i.value),1)])]),e("div",j,[e("div",z,[e("button",{onClick:t[0]||(t[0]=x=>g(u).push("/datetime")),class:"px-6 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"}," Volver "),e("button",{onClick:_,class:"px-6 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors",disabled:d.value}," Confirmar Reserva ",8,F)])])]))])])])])}}});export{L as default};
