import{d as w,z as S,u as D,n as I,l as n,m as k,c as v,o as m,b as e,t as c,s as x}from"./index-pGSg9TIk.js";import{c as E}from"./appointments.actions-BdZ1VNis.js";import{a as N}from"./dateUtils-BYq8WvRe.js";const R={class:"min-h-screen bg-gray-100 py-12 px-4 sm:px-6 lg:px-8"},T={class:"max-w-4xl mx-auto"},C={class:"bg-white rounded-lg shadow-lg overflow-hidden"},$={class:"p-8"},B={key:0,class:"text-center py-8"},A={key:1,class:"space-y-6"},J={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},O={class:"text-gray-600"},P={class:"text-sm text-gray-500 mt-1"},V={class:"text-gray-600"},j={class:"text-gray-600"},z={class:"border-t border-gray-200 pt-6"},F={class:"flex justify-between"},H=["disabled"],K=w({__name:"ReservationDetailsPage",setup(M){const g=S(),u=D(),p=I(),d=n(!1),f=n(null),a=n(null),l=n(""),i=n(""),y=()=>{const o=localStorage.getItem("selectedService"),t=localStorage.getItem("selectedDateTime");if(o&&(a.value=JSON.parse(o)),t){const{date:s,time:r}=JSON.parse(t);l.value=s,i.value=r}};k(()=>{y(),(!a.value||!l.value||!i.value)&&u.push("/service")});const _=async()=>{var o,t;try{if(d.value=!0,f.value=null,!((o=p.user)!=null&&o.id))throw new Error("No se ha encontrado el ID del usuario");if(!((t=a.value)!=null&&t.id))throw new Error("No se ha seleccionado un servicio");if(!l.value||!i.value)throw new Error("No se ha seleccionado una fecha y hora");const[s,r,h]=l.value.split("-"),b=`${h}-${r}-${s}`;await E({userId:p.user.id,date:b,time:i.value,serviceId:a.value.id,status:"confirmed"}),g.success("Reserva confirmada con éxito"),localStorage.removeItem("selectedService"),localStorage.removeItem("selectedDateTime"),u.push("/user")}catch(s){f.value=s instanceof Error?s.message:"Error al confirmar la reserva",g.error("Ya existe una reserva para esta fecha y hora")}finally{d.value=!1}};return(o,t)=>{var s,r;return m(),v("div",R,[e("div",T,[e("div",C,[e("div",$,[t[4]||(t[4]=e("h2",{class:"text-2xl font-bold text-gray-900 mb-6"},"Detalles de la Reserva",-1)),d.value?(m(),v("div",B,t[1]||(t[1]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"},null,-1),e("p",{class:"mt-4 text-gray-600"},"Procesando reserva...",-1)]))):(m(),v("div",A,[e("div",J,[e("div",null,[t[2]||(t[2]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Servicio",-1)),e("p",O,c((s=a.value)==null?void 0:s.description),1),e("p",P,"Duración: "+c((r=a.value)==null?void 0:r.duration)+" minutos",1)]),e("div",null,[t[3]||(t[3]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Fecha y Hora",-1)),e("p",V,c(x(N)(l.value)),1),e("p",j,c(i.value),1)])]),e("div",z,[e("div",F,[e("button",{onClick:t[0]||(t[0]=h=>x(u).push("/datetime")),class:"px-6 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"}," Volver "),e("button",{onClick:_,class:"px-6 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors",disabled:d.value}," Confirmar Reserva ",8,H)])])]))])])])])}}});export{K as default};
