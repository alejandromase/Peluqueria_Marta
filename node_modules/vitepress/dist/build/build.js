"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const fs_1 = require("fs");
const bundle_1 = require("./bundle");
const config_1 = require("../config");
const render_1 = require("./render");
async function build(buildOptions = {}) {
    const siteConfig = await config_1.resolveConfig(buildOptions.root);
    try {
        const result = await bundle_1.bundle(siteConfig, buildOptions);
        console.log('rendering pages...');
        for (const page of siteConfig.pages) {
            await render_1.renderPage(siteConfig, page, result);
        }
    }
    finally {
        await fs_1.promises.rmdir(siteConfig.tempDir, { recursive: true });
    }
    console.log('done.');
}
exports.build = build;
